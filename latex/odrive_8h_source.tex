\hypertarget{odrive_8h_source}{}\doxysection{odrive.\+h}
\label{odrive_8h_source}\index{/github/workspace/system/odrive/include/huron/odrive/odrive.h@{/github/workspace/system/odrive/include/huron/odrive/odrive.h}}

\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{preprocessor}{\#pragma once}}
\DoxyCodeLine{2 }
\DoxyCodeLine{3 \textcolor{preprocessor}{\#include <cstdint>}}
\DoxyCodeLine{4 \textcolor{preprocessor}{\#include <set>}}
\DoxyCodeLine{5 \textcolor{preprocessor}{\#include <string>}}
\DoxyCodeLine{6 \textcolor{preprocessor}{\#include <utility>}}
\DoxyCodeLine{7 \textcolor{preprocessor}{\#include <memory>}}
\DoxyCodeLine{8 }
\DoxyCodeLine{9 \textcolor{preprocessor}{\#include "{}odrive\_enums.h"{}}}
\DoxyCodeLine{10 \textcolor{preprocessor}{\#include "{}huron/control\_interfaces/generic\_component.h"{}}}
\DoxyCodeLine{11 }
\DoxyCodeLine{12 \textcolor{keyword}{namespace }\mbox{\hyperlink{namespacehuron}{huron}} \{}
\DoxyCodeLine{13 \textcolor{keyword}{namespace }odrive \{}
\DoxyCodeLine{14 }
\DoxyCodeLine{18 \textcolor{keyword}{class }\mbox{\hyperlink{classhuron_1_1odrive_1_1ODrive}{ODrive}} : \textcolor{keyword}{public} \mbox{\hyperlink{classhuron_1_1GenericComponent}{huron::GenericComponent}} \{}
\DoxyCodeLine{19  \textcolor{keyword}{protected}:}
\DoxyCodeLine{20   \textcolor{keyword}{static} \textcolor{keyword}{const} uint32\_t kGetTimeout = 100;  \textcolor{comment}{// ms}}
\DoxyCodeLine{21 }
\DoxyCodeLine{22   uint32\_t get\_timeout\_;}
\DoxyCodeLine{23   \textcolor{keywordtype}{bool} is\_calibrated\_ = \textcolor{keyword}{false};}
\DoxyCodeLine{24 }
\DoxyCodeLine{25  \textcolor{keyword}{public}:}
\DoxyCodeLine{26   \textcolor{keyword}{class }\mbox{\hyperlink{classhuron_1_1odrive_1_1ODrive_1_1ODriveConfiguration}{ODriveConfiguration}} : \textcolor{keyword}{public} \mbox{\hyperlink{classhuron_1_1Configuration}{huron::Configuration}} \{}
\DoxyCodeLine{27    \textcolor{keyword}{public}:}
\DoxyCodeLine{31     \mbox{\hyperlink{classhuron_1_1odrive_1_1ODrive_1_1ODriveConfiguration_ae3e9e4c96fd15245e670aa416b8190b3}{ODriveConfiguration}}(ConfigMap config\_map,}
\DoxyCodeLine{32                               std::set<std::string> valid\_keys)}
\DoxyCodeLine{33       : \mbox{\hyperlink{namespacehuron}{huron}}::\mbox{\hyperlink{classhuron_1_1Configuration}{Configuration}}(config\_map,}
\DoxyCodeLine{34                              [\&valid\_keys]() \{}
\DoxyCodeLine{35                                std::set<std::string> tmp(kODriveKeys);}
\DoxyCodeLine{36                                tmp.merge(valid\_keys);}
\DoxyCodeLine{37                                \textcolor{keywordflow}{return} tmp;}
\DoxyCodeLine{38                              \}()) \{\}}
\DoxyCodeLine{39 }
\DoxyCodeLine{40     \textcolor{keyword}{explicit} \mbox{\hyperlink{classhuron_1_1odrive_1_1ODrive_1_1ODriveConfiguration_a69457355eb37b2efef9143870274db5f}{ODriveConfiguration}}(ConfigMap config\_map)}
\DoxyCodeLine{41       : \mbox{\hyperlink{classhuron_1_1odrive_1_1ODrive_1_1ODriveConfiguration_a69457355eb37b2efef9143870274db5f}{ODriveConfiguration}}(config\_map, std::set<std::string>()) \{\}}
\DoxyCodeLine{42 }
\DoxyCodeLine{49     \mbox{\hyperlink{classhuron_1_1odrive_1_1ODrive_1_1ODriveConfiguration_a69457355eb37b2efef9143870274db5f}{ODriveConfiguration}}()}
\DoxyCodeLine{50       : \mbox{\hyperlink{classhuron_1_1odrive_1_1ODrive_1_1ODriveConfiguration}{ODriveConfiguration}}(ConfigMap(), std::set<std::string>()) \{\}}
\DoxyCodeLine{51 }
\DoxyCodeLine{52    \textcolor{keyword}{private}:}
\DoxyCodeLine{53     \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keyword}{inline} std::set<std::string> kODriveKeys\{}
\DoxyCodeLine{54       \textcolor{stringliteral}{"{}velocity\_limit"{}},}
\DoxyCodeLine{55       \textcolor{stringliteral}{"{}current\_limit"{}},}
\DoxyCodeLine{56       \textcolor{stringliteral}{"{}traj\_vel\_limit"{}},}
\DoxyCodeLine{57       \textcolor{stringliteral}{"{}traj\_accel\_limit"{}},}
\DoxyCodeLine{58       \textcolor{stringliteral}{"{}traj\_decel\_limit"{}},}
\DoxyCodeLine{59       \textcolor{stringliteral}{"{}traj\_inertia"{}}\};}
\DoxyCodeLine{60   \};}
\DoxyCodeLine{61 }
\DoxyCodeLine{62   ODrive(std::unique\_ptr<ODriveConfiguration> config, uint32\_t get\_timeout)}
\DoxyCodeLine{63       : \mbox{\hyperlink{namespacehuron}{huron}}::\mbox{\hyperlink{classhuron_1_1GenericComponent}{GenericComponent}}(std::move(config)),}
\DoxyCodeLine{64         get\_timeout\_(get\_timeout) \{\}}
\DoxyCodeLine{65   \textcolor{keyword}{explicit} ODrive(uint32\_t get\_timeout = kGetTimeout)}
\DoxyCodeLine{66       : ODrive(std::make\_unique<ODriveConfiguration>(),}
\DoxyCodeLine{67                get\_timeout) \{\}}
\DoxyCodeLine{68   ODrive(\textcolor{keyword}{const} ODrive\&) = \textcolor{keyword}{delete};}
\DoxyCodeLine{69   ODrive\& operator=(\textcolor{keyword}{const} ODrive\&) = \textcolor{keyword}{delete};}
\DoxyCodeLine{70   \string~ODrive() \textcolor{keyword}{override} = \textcolor{keywordflow}{default};}
\DoxyCodeLine{71 }
\DoxyCodeLine{76   \textcolor{keywordtype}{void} \mbox{\hyperlink{classhuron_1_1odrive_1_1ODrive_a885977f31a05791f527ff7149d9a930e}{Initialize}}() \textcolor{keyword}{override};}
\DoxyCodeLine{77 }
\DoxyCodeLine{81   \textcolor{keywordtype}{bool} \mbox{\hyperlink{classhuron_1_1odrive_1_1ODrive_a1290fc9d120213f7e4bb1062fabe8496}{Calibrate}}();}
\DoxyCodeLine{82 }
\DoxyCodeLine{83   \textcolor{keywordtype}{void} \mbox{\hyperlink{classhuron_1_1odrive_1_1ODrive_adce38de6e9d64a0afdcfd62dae8e4999}{ConfigureKey}}(std::string config\_key, std::any config\_value) \textcolor{keyword}{override};}
\DoxyCodeLine{84 }
\DoxyCodeLine{85   \textcolor{comment}{// Get functions (msg.rtr bit must be set)}}
\DoxyCodeLine{86   \textcolor{keyword}{virtual} \textcolor{keywordtype}{bool} GetMotorError(uint64\_t\& motor\_error) = 0;}
\DoxyCodeLine{87   \textcolor{keyword}{virtual} \textcolor{keywordtype}{bool} GetEncoderError(uint32\_t\& encoder\_error) = 0;}
\DoxyCodeLine{88   \textcolor{keyword}{virtual} \textcolor{keywordtype}{bool} GetControllerError(uint32\_t\& controller\_error) = 0;}
\DoxyCodeLine{89   \textcolor{keyword}{virtual} \textcolor{keywordtype}{bool} GetSensorlessError(uint32\_t\& sensorless\_error) = 0;}
\DoxyCodeLine{90   \textcolor{keyword}{virtual} \textcolor{keywordtype}{bool} GetEncoderEstimates(\textcolor{keywordtype}{float}\& pos, \textcolor{keywordtype}{float}\& vel) = 0;}
\DoxyCodeLine{91   \textcolor{keyword}{virtual} \textcolor{keywordtype}{bool} GetEncoderCount(int32\_t\& shadow\_cnt, int32\_t\& cnt\_cpr) = 0;}
\DoxyCodeLine{92   \textcolor{keyword}{virtual} \textcolor{keywordtype}{bool} GetIq(\textcolor{keywordtype}{float}\& iq\_setpoint, \textcolor{keywordtype}{float}\& iq\_measured) = 0;}
\DoxyCodeLine{93   \textcolor{keyword}{virtual} \textcolor{keywordtype}{bool} GetSensorlessEstimates(\textcolor{keywordtype}{float}\& pos, \textcolor{keywordtype}{float}\& vel) = 0;}
\DoxyCodeLine{94   \textcolor{keyword}{virtual} \textcolor{keywordtype}{bool} GetBusVoltageCurrent(\textcolor{keywordtype}{float}\& bus\_voltage, \textcolor{keywordtype}{float}\& bus\_current) = 0;}
\DoxyCodeLine{95   \textcolor{comment}{// msg.rtr bit must NOT be set}}
\DoxyCodeLine{96   \textcolor{keyword}{virtual} \textcolor{keywordtype}{bool} GetAdcVoltage(\textcolor{keywordtype}{float}\& adc\_voltage) = 0;}
\DoxyCodeLine{97 }
\DoxyCodeLine{98   \textcolor{comment}{// Set functions}}
\DoxyCodeLine{99   \textcolor{keyword}{virtual} \textcolor{keywordtype}{bool} SetAxisNodeid(uint32\_t axis\_id) = 0;}
\DoxyCodeLine{100   \textcolor{keyword}{virtual} \textcolor{keywordtype}{bool} SetAxisRequestedState(uint32\_t state) = 0;}
\DoxyCodeLine{101   \textcolor{keyword}{virtual} \textcolor{keywordtype}{bool} SetAxisStartupConfig() = 0;}
\DoxyCodeLine{102   \textcolor{keyword}{virtual} \textcolor{keywordtype}{bool} SetInputPos(\textcolor{keywordtype}{float} input\_pos, int16\_t vel\_ff,}
\DoxyCodeLine{103                int16\_t torque\_ff) = 0;}
\DoxyCodeLine{104   \textcolor{keyword}{virtual} \textcolor{keywordtype}{bool} SetInputVel(\textcolor{keywordtype}{float} input\_vel, \textcolor{keywordtype}{float} torque\_ff) = 0;}
\DoxyCodeLine{105   \textcolor{keyword}{virtual} \textcolor{keywordtype}{bool} SetInputTorque(\textcolor{keywordtype}{float} input\_torque) = 0;}
\DoxyCodeLine{106   \textcolor{keyword}{virtual} \textcolor{keywordtype}{bool} SetControllerModes(int32\_t control\_mode, int32\_t input\_mode) = 0;}
\DoxyCodeLine{107   \textcolor{keyword}{virtual} \textcolor{keywordtype}{bool} SetLimits(\textcolor{keywordtype}{float} velocity\_limit, \textcolor{keywordtype}{float} current\_limit) = 0;}
\DoxyCodeLine{108   \textcolor{keyword}{virtual} \textcolor{keywordtype}{bool} SetTrajVelLimit(\textcolor{keywordtype}{float} traj\_vel\_limit) = 0;}
\DoxyCodeLine{109   \textcolor{keyword}{virtual} \textcolor{keywordtype}{bool} SetTrajAccelLimits(\textcolor{keywordtype}{float} traj\_accel\_limit,}
\DoxyCodeLine{110                   \textcolor{keywordtype}{float} traj\_decel\_limit) = 0;}
\DoxyCodeLine{111   \textcolor{keyword}{virtual} \textcolor{keywordtype}{bool} SetTrajInertia(\textcolor{keywordtype}{float} traj\_inertia) = 0;}
\DoxyCodeLine{112   \textcolor{keyword}{virtual} \textcolor{keywordtype}{bool} SetLinearCount(int32\_t position) = 0;}
\DoxyCodeLine{113   \textcolor{keyword}{virtual} \textcolor{keywordtype}{bool} SetPosGain(\textcolor{keywordtype}{float} pos\_gain) = 0;}
\DoxyCodeLine{114   \textcolor{keyword}{virtual} \textcolor{keywordtype}{bool} SetVelGains(\textcolor{keywordtype}{float} vel\_gain, \textcolor{keywordtype}{float} vel\_interator\_gain) = 0;}
\DoxyCodeLine{115 }
\DoxyCodeLine{116   \textcolor{comment}{// Other functions}}
\DoxyCodeLine{117   \textcolor{keyword}{virtual} \textcolor{keywordtype}{bool} Nmt() = 0;}
\DoxyCodeLine{118   \textcolor{keyword}{virtual} \textcolor{keywordtype}{bool} Estop() = 0;}
\DoxyCodeLine{119   \textcolor{keyword}{virtual} \textcolor{keywordtype}{bool} ClearErrors() = 0;}
\DoxyCodeLine{120   \textcolor{keyword}{virtual} \textcolor{keywordtype}{bool} StartAnticogging() = 0;}
\DoxyCodeLine{121 \};}
\DoxyCodeLine{122 }
\DoxyCodeLine{123 \}  \textcolor{comment}{// namespace odrive}}
\DoxyCodeLine{124 \}  \textcolor{comment}{// namespace huron}}

\end{DoxyCode}
